import{V as t}from"./viewerjs-lrcFL2x7.js";import{h as e,r,w as n,n as o,d as i,a as c,o as u,b as a,c as s,e as f,f as l}from"./@vue-f7SN4N0o.js";const v="object"==typeof global&&global&&global.Object===Object&&global;var p="object"==typeof self&&self&&self.Object===Object&&self;const d=v||p||Function("return this")();const b=d.Symbol;var y=Object.prototype,g=y.hasOwnProperty,j=y.toString,m=b?b.toStringTag:void 0;var h=Object.prototype.toString;var w="[object Null]",O="[object Undefined]",_=b?b.toStringTag:void 0;function $(t){return null==t?void 0===t?O:w:_&&_ in Object(t)?function(t){var e=g.call(t,m),r=t[m];try{t[m]=void 0;var n=!0}catch{}var o=j.call(t);return n&&(e?t[m]=r:delete t[m]),o}(t):function(t){return h.call(t)}(t)}function A(t){return null!=t&&"object"==typeof t}var x="[object Symbol]";const T=Array.isArray;var M=/\s/;var P=/^\s+/;function S(t){return t&&t.slice(0,function(t){for(var e=t.length;e--&&M.test(t.charAt(e)););return e}(t)+1).replace(P,"")}function V(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var E=NaN,D=/^[-+]0x[0-9a-f]+$/i,F=/^0b[01]+$/i,I=/^0o[0-7]+$/i,U=parseInt;function C(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||A(t)&&$(t)==x}(t))return E;if(V(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=V(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=S(t);var r=F.test(t);return r||I.test(t)?U(t.slice(2),r?2:8):D.test(t)?E:+t}function W(t){return t}var k="[object AsyncFunction]",B="[object Function]",L="[object GeneratorFunction]",N="[object Proxy]";function R(t){if(!V(t))return!1;var e=$(t);return e==B||e==L||e==k||e==N}const q=d["__core-js_shared__"];var z,G=(z=/[^.]+$/.exec(q&&q.keys&&q.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"";var H=Function.prototype.toString;var K=/^\[object .+?Constructor\]$/,J=Function.prototype,Q=Object.prototype,X=J.toString,Y=Q.hasOwnProperty,Z=RegExp("^"+X.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tt(t){return!(!V(t)||function(t){return!!G&&G in t}(t))&&(R(t)?Z:K).test(function(t){if(null!=t){try{return H.call(t)}catch{}try{return t+""}catch{}}return""}(t))}var et=Date.now;function rt(t){return function(){return t}}var nt=function(){try{var t=function(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return tt(r)?r:void 0}(Object,"defineProperty");return t({},"",{}),t}catch{}}();const ot=nt;var it=ot?function(t,e){return ot(t,"toString",{configurable:!0,enumerable:!1,value:rt(e),writable:!0})}:W;var ct=function(t){var e=0,r=0;return function(){var n=et(),o=16-(n-r);if(r=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(it);const ut=ct;var at=9007199254740991,st=/^(?:0|[1-9]\d*)$/;function ft(t,e){var r=typeof t;return!!(e=null==e?at:e)&&("number"==r||"symbol"!=r&&st.test(t))&&t>-1&&t%1==0&&t<e}function lt(t,e,r){"__proto__"==e&&ot?ot(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function vt(t,e){return t===e||t!=t&&e!=e}var pt=Object.prototype.hasOwnProperty;function dt(t,e,r){var n=t[e];(!pt.call(t,e)||!vt(n,r)||void 0===r&&!(e in t))&&lt(t,e,r)}var bt=Math.max;function yt(t,e){return ut(function(t,e,r){return e=bt(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=bt(n.length-e,0),c=Array(i);++o<i;)c[o]=n[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=n[o];return u[e]=r(c),function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,u)}}(t,e,W),t+"")}var gt=9007199254740991;function jt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=gt}function mt(t){return null!=t&&jt(t.length)&&!R(t)}function ht(t,e,r){if(!V(r))return!1;var n=typeof e;return!!("number"==n?mt(r)&&ft(e,r.length):"string"==n&&e in r)&&vt(r[e],t)}var wt=Object.prototype;function Ot(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||wt)}function _t(t){return A(t)&&"[object Arguments]"==$(t)}var $t=Object.prototype,At=$t.hasOwnProperty,xt=$t.propertyIsEnumerable,Tt=_t(function(){return arguments}())?_t:function(t){return A(t)&&At.call(t,"callee")&&!xt.call(t,"callee")};const Mt=Tt;var Pt="object"==typeof exports&&exports&&!exports.nodeType&&exports,St=Pt&&"object"==typeof module&&module&&!module.nodeType&&module,Vt=St&&St.exports===Pt?d.Buffer:void 0;const Et=(Vt?Vt.isBuffer:void 0)||function(){return!1};var Dt={};Dt["[object Float32Array]"]=Dt["[object Float64Array]"]=Dt["[object Int8Array]"]=Dt["[object Int16Array]"]=Dt["[object Int32Array]"]=Dt["[object Uint8Array]"]=Dt["[object Uint8ClampedArray]"]=Dt["[object Uint16Array]"]=Dt["[object Uint32Array]"]=!0,Dt["[object Arguments]"]=Dt["[object Array]"]=Dt["[object ArrayBuffer]"]=Dt["[object Boolean]"]=Dt["[object DataView]"]=Dt["[object Date]"]=Dt["[object Error]"]=Dt["[object Function]"]=Dt["[object Map]"]=Dt["[object Number]"]=Dt["[object Object]"]=Dt["[object RegExp]"]=Dt["[object Set]"]=Dt["[object String]"]=Dt["[object WeakMap]"]=!1;var Ft="object"==typeof exports&&exports&&!exports.nodeType&&exports,It=Ft&&"object"==typeof module&&module&&!module.nodeType&&module,Ut=It&&It.exports===Ft&&v.process,Ct=function(){try{return It&&It.require&&It.require("util").types||Ut&&Ut.binding&&Ut.binding("util")}catch{}}();var Wt=Ct&&Ct.isTypedArray,kt=Wt?function(t){return function(e){return t(e)}}(Wt):function(t){return A(t)&&jt(t.length)&&!!Dt[$(t)]};const Bt=kt;var Lt=Object.prototype.hasOwnProperty;function Nt(t,e){var r=T(t),n=!r&&Mt(t),o=!r&&!n&&Et(t),i=!r&&!n&&!o&&Bt(t),c=r||n||o||i,u=c?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],a=u.length;for(var s in t)(e||Lt.call(t,s))&&(!c||!("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||ft(s,a)))&&u.push(s);return u}var Rt=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object);const qt=Rt;var zt=Object.prototype.hasOwnProperty;function Gt(t){return mt(t)?Nt(t):function(t){if(!Ot(t))return qt(t);var e=[];for(var r in Object(t))zt.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}var Ht=Object.prototype.hasOwnProperty,Kt=function(t){return yt((function(e,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,c=o>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,c&&ht(r[0],r[1],c)&&(i=o<3?void 0:i,o=1),e=Object(e);++n<o;){var u=r[n];u&&t(e,u,n,i)}return e}))}((function(t,e){if(Ot(e)||mt(e))!function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,c=e.length;++i<c;){var u=e[i],a=n?n(r[u],t[u],u,r,t):void 0;void 0===a&&(a=t[u]),o?lt(r,u,a):dt(r,u,a)}}(e,Gt(e),t);else for(var r in e)Ht.call(e,r)&&dt(t,r,e[r])}));const Jt=Kt;var Qt=Object.prototype.hasOwnProperty;function Xt(t){if(!V(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Ot(t),r=[];for(var n in t)"constructor"==n&&(e||!Qt.call(t,n))||r.push(n);return r}function Yt(t){return mt(t)?Nt(t,!0):Xt(t)}const Zt=function(){return d.Date.now()};var te=Math.max,ee=Math.min;function re(t,e,r){var n,o,i,c,u,a,s=0,f=!1,l=!1,v=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function p(e){var r=n,i=o;return n=o=void 0,s=e,c=t.apply(i,r)}function d(t){var r=t-a;return void 0===a||r>=e||r<0||l&&t-s>=i}function b(){var t=Zt();if(d(t))return y(t);u=setTimeout(b,function(t){var r=e-(t-a);return l?ee(r,i-(t-s)):r}(t))}function y(t){return u=void 0,v&&n?p(t):(n=o=void 0,c)}function g(){var t=Zt(),r=d(t);if(n=arguments,o=this,a=t,r){if(void 0===u)return function(t){return s=t,u=setTimeout(b,e),f?p(t):c}(a);if(l)return clearTimeout(u),u=setTimeout(b,e),p(a)}return void 0===u&&(u=setTimeout(b,e)),c}return e=C(e)||0,V(r)&&(f=!!r.leading,i=(l="maxWait"in r)?te(C(r.maxWait)||0,e):i,v="trailing"in r?!!r.trailing:v),g.cancel=function(){void 0!==u&&clearTimeout(u),s=0,n=a=o=u=void 0},g.flush=function(){return void 0===u?c:y(Zt())},g}var ne=Object.prototype,oe=ne.hasOwnProperty,ie=yt((function(t,e){t=Object(t);var r=-1,n=e.length,o=n>2?e[2]:void 0;for(o&&ht(e[0],e[1],o)&&(n=1);++r<n;)for(var i=e[r],c=Yt(i),u=-1,a=c.length;++u<a;){var s=c[u],f=t[s];(void 0===f||vt(f,ne[s])&&!oe.call(t,s))&&(t[s]=i[s])}return t}));const ce=ie,ue=({images:n=[],options:o})=>{o=Jt(o,{inline:!1});const i=document.createElement("div"),c=e("div",{style:{display:"none"},class:["__viewer-token"]},n.map((t=>e("img","string"==typeof t?{src:t}:t))));r(c,i);const u=i.firstElementChild;document.body.appendChild(u);const a=new t(u,o),s=a.destroy.bind(a);return a.destroy=function(){return s(),r(null,i),a},a.show(),u.addEventListener("hidden",(function(){this.viewer===a&&a.destroy()})),a},ae=({name:e="viewer",debug:r=!1}={})=>{async function i(r,n,i=!1,u=!1){await o(),(!u||function(t){const e=t.innerHTML.match(/<img([\w\W]+?)[\\/]?>/g),r=e?e.join(""):void 0;return t.__viewerImageDiffCache===r?(a("Element change detected, but image(s) has not changed"),!1):(a("Image change detected"),t.__viewerImageDiffCache=r,!0)}(r))&&(i||!r[`$${e}`]?(c(r),r[`$${e}`]=new t(r,n),a("Viewer created")):(r[`$${e}`].update(),a("Viewer updated")))}function c(t){!t[`$${e}`]||(t[`$${e}`].destroy(),delete t[`$${e}`],a("Viewer destroyed"))}function u(t){!t.__viewerMutationObserver||(t.__viewerMutationObserver.disconnect(),delete t.__viewerMutationObserver,a("observer destroyed"))}function a(...t){r&&console.log(...t)}return{mounted(t,e,r){a("Viewer bind");const o=re(i,50);o(t,e.value),function(t,e,r,o){t.__viewerUnwatch=n((()=>e.value),((r,n)=>{a("Change detected by watcher: ",e.value),o(t,r,!0,!1)}),{deep:!0}),a("Watcher created, expression: ",e.value)}(t,e,0,o),e.modifiers.static||function(t,e,r,n){u(t);const o=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(!o)return void a("Observer not supported");const i=new o((o=>{o.forEach((o=>{a(`Viewer mutation:${o.type}`),r(t,e,n,!0)}))}));i.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),t.__viewerMutationObserver=i,a("Observer created")}(t,e.value,o,e.modifiers.rebuild)},unmounted(t){a("Viewer unbind"),u(t),function(t){!t.__viewerUnwatch||(t.__viewerUnwatch(),delete t.__viewerUnwatch,a("Watcher destroyed"))}(t),c(t)}}},se=i({name:"Viewer",props:{images:{type:Array,default:()=>[]},rebuild:{type:Boolean,default:!1},trigger:{type:Object,default:null},options:{type:Object,default:()=>null}},emits:["inited"],setup(e,{emit:r}){let i;const s=c();function f(){i=new t(s.value,e.options),r("inited",i)}function l(){i&&i.destroy()}function v(){l(),f()}function p(){i?(i.update(),r("inited",i)):f()}function d(){e.rebuild?v():p()}const b={deep:!0};return n((()=>e.images),(()=>{o((()=>{d()}))}),b),n((()=>e.trigger),(()=>{o((()=>{d()}))}),b),n((()=>e.options),(()=>{o((()=>{v()}))}),b),u((()=>f())),a((()=>l())),{root:s,createViewer:f,rebuildViewer:v,updateViewer:p,destroyViewer:l}}}),fe=(t,e)=>{const r=t.__vccOpts||t;for(const[n,o]of e)r[n]=o;return r},le={ref:"root"};const ve=fe(se,[["render",function(t,e,r,n,o,i){return s(),f("div",le,[l(t.$slots,"default",{images:t.images,options:t.options})],512)}]]),pe={install(e,{name:r="viewer",debug:n=!1,defaultOptions:o}={}){o&&t.setDefaults(o),e.config.globalProperties[`$${r}Api`]=ue,e.component(r,ce(ve,{name:r})),e.directive(r,ae({name:r,debug:n}))},setDefaults(e){t.setDefaults(e)}};export{pe as r};
